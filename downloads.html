<!DOCTYPE html>
<html lang="en">

<head>

  <title>Download Moloch</title>

  <!-- Required meta tags always come first -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="description" content="Moloch downloads" />
  <!-- facebook open graph tags -->
  <meta property="og:url" content="http://molo.ch/downloads" />
  <meta property="og:description" content="Moloch downloads" />
  <meta property="og:image" content="moloch_2x2.png" />
  <!-- twitter card tags additive with the og: tags -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:domain" value="molo.ch" />
  <meta name="twitter:description" value="Moloch downloads" />
  <meta name="twitter:image" content="moloch_2x2.png" />
  <meta name="twitter:url" value="http://molo.ch/downloads" />

  <!-- fontawesome http://fontawesome.io/ -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- Bootstrap CSS https://getbootstrap.com/ -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
  <!-- custom index page styles -->
  <link rel="stylesheet" type="text/css" href="index.css">

</head>

<body id="viewport">

  <div class="container-fluid downloads-content">

    <nav class="navbar navbar-dark bg-dark fixed-top navbar-expand-md">
      <button class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#collapsingNavbar"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse"
        id="collapsingNavbar">
        <ul class="nav navbar-nav mr-auto" role="tablist">
          <li class="nav-item">
            <a class="nav-link"
              href="/index#home">
              <img src="simple_logo.png" />
            </a>
          </li>
          <li class="nav-item dropdown ml-4">
            <a class="nav-link dropdown-toggle"
              data-toggle="dropdown"
              href="#"
              role="button"
              aria-haspopup="true"
              aria-expanded="false">
              <strong>Moloch</strong>
            </a>
            <div class="dropdown-menu">
              <a class="dropdown-item" href="/index#demo">Demo</a>
              <a class="dropdown-item" href="/index#screenshots">Screenshots</a>
              <a class="dropdown-item" href="/index#downloads">Downloads</a>
              <a class="dropdown-item" href="/index#help">Help</a>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link active"
              href="/downloads">
              Downloads
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link"
              href="/estimators">
              Estimators
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link"
              href="/faq">
              FAQ
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link"
              href="/on">
              MolochON 2019
            </a>
          </li>
          <!-- TODO wiki dropdown with api/settings/architectures -->
        </ul>
        <form class="form-inline">
          <a href="https://slackinvite.molo.ch/"
            class="btn btn-sm btn-outline-secondary ml-1"
            title="Join the conversation on Slack"
            data-toggle="tooltip"
            data-placement="left">
            <span class="fa fa-slack fa-2x"></span>
            <span class="hide">Slack Channel</span>
          </a>
          <a href="https://github.com/aol/moloch"
            title="View Moloch on GitHub"
            data-toggle="tooltip" data-placement="left"
            class="btn btn-sm btn-outline-info ml-1">
            <span class="fa fa-github fa-2x"></span>
            <span class="hide">Moloch GitHub</span>
          </a>
        </form>
      </div>
    </nav>

    <div class="row mb-4 mt-4">
      <div class="col align-center">
        <a class="btn btn-outline-danger btn-lg mr-3 btn-fw mb-2"
          href="https://s3.amazonaws.com/files.molo.ch/NOTICE.txt">
          NOTICE
        </a>
        <a class="btn btn-outline-primary btn-lg mr-3 btn-fw mb-2"
          href="https://raw.githubusercontent.com/aol/moloch/master/CHANGELOG">
          CHANGELOG
        </a>
        <a class="btn btn-outline-info btn-lg mr-3 btn-fw mb-2"
          href="https://raw.githubusercontent.com/aol/moloch/master/release/README.txt">
          Instructions
        </a>
        <a class="btn btn-outline-success btn-lg mr-3 btn-fw mb-2"
          href="https://github.com/aol/moloch/issues/new">
          Open an Issue
        </a>
      </div>
    </div>
    <div class="row mb-2 mr-5 ml-5">
      <div class="col">
        <div class="jumbotron pb-2 pt-4">
          <h3 class="purp-text pb-3 text-center">
            <span class="fa fa-exclamation-triangle">
            </span>&nbsp;
            Before upgrading
            &nbsp;<span class="fa fa-exclamation-triangle">
            </span>
          </h3>
          <div class="row pb-2">
            <div class="col-lg-3 col-md-6">
              <p>
                <strong>To Moloch 1.5</strong>
                <br>
                Upgrade to Moloch 1.0 or 1.1 and finish any reindexing.
              </p>
            </div>
            <div class="col-lg-3 col-md-6">
              <p>
                <strong>To Moloch 1.0 or 1.1</strong>
                <br>
                Read the How do I upgrade to Moloch 1.0 answer in the FAQ.
                <br>
                <em>
                  Upgrading to 1.0 takes some time, work, and requires ES 5.x.
                </em>
              </p>
            </div>
            <div class="col-lg-3 col-md-6">
              <p>
                <strong>From ES 5 to ES 6</strong>
                <br>
                Read the How do I upgrade to ES 6 answer in the FAQ.
              </p>
            </div>
            <div class="col-lg-3 col-md-6">
              <p>
                <strong>From ES 2 to ES 5</strong>
                <br>
                Read the How do I upgrade to ES 5 answer in the FAQ.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="downloads mb-5 mr-5 ml-5 pl-3 pr-3">
      <h2 class="loading-downloads text-center mb-5 pb-5 mt-5">
        <span class="fa fa-spinner fa-spin"></span>&nbsp;
        Loading Moloch downloads...
      </h2>
      <div class="main-downloads">
      </div>
      <div class="row show-more-downloads text-center mt-3 mb-4"
        style="display:none;">
        <div class="col-md-12">
          <a href="#"
            onclick="toggleMoreDownloads(event)"
            class="cursor-pointer no-decoration show-more-downloads-btn">
            <span class="fa fa-chevron-down"></span>&nbsp;
            show more downloads
          </a>
        </div>
      </div>
      <div class="more-downloads"
        style="display:none;">
        <div class="row show-more-downloads text-center mt-3">
          <div class="col-md-12">
            <a href="#"
              onclick="toggleMoreDownloads(event)"
              class="cursor-pointer no-decoration show-more-downloads-btn">
              <span class="fa fa-chevron-up"></span>&nbsp;
              hide more downloads
            </a>
          </div>
        </div>
      </div>

      <div class="row downloads-error mt-5 mb-5 pb-5"
        style="display:none;">
        <div class="col-12 text-center">
          <h4 class="purp-text">
            <span class="fa fa-frown-o fa-lg">
            </span>&nbsp;
            Sorry, we couldn't retrieve Moloch downloads.
            &nbsp;<span class="fa fa-frown-o fa-lg">
            </span>
            <br>
            Please try again later.
          </h4>
          <p>
            Meanwhile, view Moloch on
            <a href="https://github.com/aol/moloch"
              class="no-decoration">
              GitHub
            </a>
          </p>
        </div>
      </div>

      <div class="mt-5 commit-downloads-container"
        style="display:none;">
        <h3 class="text-center">
          <span class="purp-text">
            Feeling adventurous?
          </span>
          Try our latest commit!
        </h3>
        <hr>
        <table class="table">
          <tbody class="commit-downloads">
          </tbody>
        </table>
      </div>

    </div>

  </div>

  <!-- footer -->
  <div class="text-center">
    <img height="28px"
      class="footer-owl"
      alt="Moloch Logo"
      src="simple_logo.png"
    />
  </div>

  <footer class="footer small text-center">
    <strong class="pull-left">
      <span>Moloch</span>&nbsp;&nbsp;&nbsp;
      <a href="https://github.com/aol/moloch" class="no-decoration">
        <span class="fa fa-lg fa-github"></span>
        <span class="hide">Moloch GitHub</span>
      </a>
    </strong>
    <a href="https://github.com/aol/moloch/issues"
      class="no-decoration pull-left ml-3"
      title="Report it!" data-toggle="tooltip">
      Found an Issue?
    </a>
    <span class="pull-right">
      <a href="https://github.com/aol/moloch/wiki"
        class="no-decoration">Wiki</a>&nbsp;&nbsp;&nbsp;
      <a href="https://github.com/aol/moloch/wiki/API"
        class="no-decoration">API</a>&nbsp;&nbsp;&nbsp;
      <a href="/faq"
        class="no-decoration">FAQ</a>
    </span>
  </footer> <!-- /footer -->

  <!-- jQuery first, then Bootstrap JS. -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
  <!-- Bootstrap JS -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>

  <script src="downloads.js"></script>

  <script>
    let showMoreDownloads = false;

    function toggleMoreDownloads (event) {
      event.preventDefault();

      showMoreDownloads = !showMoreDownloads;
      let btn = $('.show-more-downloads-btn');
      let moreDownloadsDiv = $('.more-downloads');

      moreDownloadsDiv.toggle();

      if (showMoreDownloads) {
        btn.html('<span class="fa fa-chevron-up"></span>&nbsp;hide more downloads');
      } else {
        btn.html('<span class="fa fa-chevron-down"></span>&nbsp;show more downloads');
      }

      return false;
    }

    $(function () {
      function buildDownloadVersionRow (version, btnType) {
        let html = `<div class="row text-center">
                     <div class="col-lg-2 mb-2">
                       <div><strong>${version.title}</strong></div>
                       <div class="time"><small>${version.modified}</small></div>
                     </div>`;

        let downloads = version.downloads;
        for (let i = 0, len = downloads.length; i < len; ++i) {
          let download = downloads[i];
          html += `<div class="col-lg-2 mb-2">
                     <a href="${download.url}" class="btn ${btnType}">
                       ${download.title}
                     </a>
                   </div>`;
        }

        html += '</div>';

        return html;
      }

      function setupPage (versions, nightlies, commities, sortedVersions) {
        let mainDownloadsHtml = '', moreDownloadsHtml = '';

        let nightlyDownloadsHtml = buildDownloadVersionRow(nightlies, 'btn-outline-danger');
        let commitDownloadsHtml = buildDownloadVersionRow(commities, 'btn-outline-danger');

        for (var v = 0, vlen = sortedVersions.length; v < vlen; ++v) {
          if (versions.hasOwnProperty(sortedVersions[v])) {
            let version = versions[sortedVersions[v]];
            let html = buildDownloadVersionRow(version, 'btn-outline-primary');

            if (v < 3)  { mainDownloadsHtml += html; }
            else        { moreDownloadsHtml += html; }
          }
        }


        $('.show-more-downloads').show();
        $('.commit-downloads-container').show();
        $('.main-downloads').append(mainDownloadsHtml);
        $('.more-downloads').prepend(moreDownloadsHtml);
        $('.nightly-downloads').append(nightlyDownloadsHtml);
        $('.commit-downloads').append(commitDownloadsHtml);
      }

      function setupError() {
        $('.downloads-error').show();
        $('.loading-downloads').hide();
        $('.nightly-downloads').hide();
        $('.commit-downloads-container').hide();
        $('.show-more-downloads-btn').hide();
        $('.show-more-downloads').hide();
      }

      $.ajax({
        url: 'https://s3.amazonaws.com/files.molo.ch',
        type: 'GET',
        crossDomain: true,
        dataType: 'xml',
        success: function (xml) {
          let downloads = parseXML(xml);
          setupPage(downloads.downloads, downloads.nightlies, downloads.commities, downloads.sortedVersions);
          $('.loading-downloads').hide();
        },
        error: function(xhr, textStatus, errorThrown) {
          setupError();
        }
      });
    });
  </script>

</body>

</html>
